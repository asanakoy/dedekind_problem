\chapter{Основные понятия и предварительные результаты}
%\section{Основные понятия и предварительные результаты}
Пусть $B=\{0,1\}$ и $\alpha = (a_1, \dots, a_n)$, $\beta = (b_1, \dots, b_n)$ -- 
бинарные веторы из $B^n$. \emph{Порядковый номер} вектора
$\alpha$ -- это целое число 
$\#(\alpha) = a_1 2^{n-1} + a_2 2^{n-2} + \dots + a_n 2^0$.
Вектор $\alpha$ \emph{лексикографически предшествует} вектору 
$\beta$, если $\exists$ целое $k, 1 \leq k \leq n$, такое что
$a_i = b_i, i=\overline{1,k-1}$ и $a_k < b_k$, 
или если $\alpha = \beta$. Вектора из $B^n$ упорядочены
в лексикографическом порядке тогда и только тогда, когда 
их порядковые номера образуют последовательность $0, 1, \dots, 2^n - 1$.\par
Отношение ''$\preceq$'' определено на $B^n \times B^n$ следующим образом:
$\alpha \preceq \beta$  если 
$a_i \leq b_i, \forall i = \overline{1,n}$. 
Это отношение рефлексивно, антисимметрично и транзитивно и, следовательно,
$B^n$  -- частично упорядоченное множество (ЧУМ) по отношению к нему. 
Когда $\alpha \preceq \beta$ или $\beta \preceq \alpha$, будем называть
$\al$ и $\be$ \emph{сравнимыми}, в противном случае они \emph{несравнимы}.\par
  Булевая функция $f$ от $n$ аргументов -- это отображение 
$f : B^n \rightarrow B$. Функция $f$ называется \emph{монотонной} 
если $\forall \al, \be \in B^n$ верна импликация 
$\al \preceq \be \Rightarrow f(\al) \leq f(\be)$.
\begin{Theorem} 
Дизъюнкция и конъюнкция монотонных булевых функция (МБФ) есть МБФ.
\end{Theorem}
$\square$
 Пусть $g$ и $h$ есть МБФ. Тогда, если $a=(a_1, a_2, \dots , a_n)$ и $b=(b_1, b_2, \dots, b_n)$ --
        два сравнимых двоичных набора, причем $a \prec b$, то согласно монотонности имеем $g(a) \leq g(b)$
        и $h(a) \leq h(b)$.\\

Сначала докажем теорему для случая конъюнкции. \\
 Пусть 
 \begin{equation}\label{1.1}
 f(\widetilde{x}^n) = g(\widetilde{x}^n) \wedge h(\widetilde{x}^n),
 \end{equation}
  1). Если $g(a) = g(b) = 0$ (или $h(a) = h(b) = 0$), то, согласно (\ref{1.1}), имеем $f(a) = f(b) = 0$, т.е.
  верна импликация
  \begin{equation}\label{1.2}
	      a \prec b \Rightarrow f(a) \leq f(b)
  \end{equation}
  2) Если $g(a) = g(b) = h(a) = h(b) = 1$, то, согласно (\ref{1.1}), имеем $f(a) = f(b) = 1$. Отсюда
  верна импликация (\ref{1.2}).\\
  3) Если $g(a) = 0, \quad g(b) = 1$ и $h(a) = 0, \quad h(b) = 1$, то, согласно (\ref{1.1}), имеем $f(a) = 0, f(b) = 1$. Отсюда
  верна импликация (\ref{1.2}).\\
  4) Если $g(a) = 0, \quad g(b) = 1$ и $h(a) = h(b) = 1$ (или наоборот), то, согласно (\ref{1.1}), имеем $f(a) = 0, f(b) = 1$. И снова
  верна импликация (\ref{1.2}).\par
    Таким образом, если БФ есть конъюнкция двух МБФ, то она монотонна.\\
  
Теперь докажем и для случая дизъюнкции. \\
 Пусть 
 \begin{equation}\label{1.3}
 f(\widetilde{x}^n) = g(\widetilde{x}^n) \vee h(\widetilde{x}^n),
 \end{equation}
  1) Если $g(a) = g(b) = h(a) = h(b) = 0$, то, согласно (\ref{1.3}), имеем $f(a) = f(b) = 0$, т.е.
  верна импликация (\ref{1.2}).\\
  2) Если $g(a) = g(b) =  1$ или $h(a) = h(b) = 1$, то, согласно (\ref{1.3}), имеем $f(a) = f(b) = 1$. Отсюда
  верна импликация (\ref{1.2}).\\
  3) Если $g(a) = 0, \quad g(b) = 1$ и $h(a) = 0, \quad h(b) = 1$, то, согласно (\ref{1.3}), имеем $f(a) = 0, f(b) = 1$. Отсюда
  верна импликация (\ref{1.2}).\\
  4) Если $g(a) = 0, \quad g(b) = 1$ и $h(a) = h(b) = 0$ (или наоборот), то, согласно (\ref{1.3}), имеем $f(a) = 0, f(b) = 1$. И снова
  верна импликация (\ref{1.2}).\par
  Таким образом, если БФ есть дизъюнкция двух МБФ, то она монотонна.
  $\blacksquare$
  
  \begin{Corollary}
    Любая ДНФ без отрицаний задает МБФ.
  \end{Corollary}
    $\square$
    Следует из того, что любая ДНФ получается из МБФ от одной переменной вида $x$ и констант $1,\ 0$
    с помощью конечного числа операций дизъюнкции и конъюнкци.
    $\blacksquare$
  \begin{Corollary}
    (\cite{Moschenski-2001}) Любая неконстантная МБФ может быть задана ДНФ без отрицаний.
  \end{Corollary}
   \begin{Corollary}
    $\psi(n) \leq 2^{2^n-1}-1$.
  \end{Corollary}
   $\square$
    Следует из того, что число всех ДНФ без отрицаний $2^{2^n-1}-1$.
    $\blacksquare$
  \begin{Corollary}
    (\cite{MDNF})
    Любая неконстантная МБФ представима в виде единственной
    минимальной ДНФ (МДНФ) , состоящей из простых импликант без отрицаний, 
    ни к каким двум из которых не пременимо правило поглощения 
    ($x \vee xy = x$).
  \end{Corollary}
  \begin{Remark}
    Если одна из БФ $g$ или $h$ не является монотонной, то утверждать о монотонности 
    $g \wedge h$ или $g \vee h$ не следует.
    Например, $0 \vee \overline{x} = \overline{x}$ -- не МБФ, хотя $0$ - МБФ.
    И $1 \wedge \overline{x} = \overline{x}$ -- не МБФ, хотя $1$ - МБФ.
   \end{Remark}
   \begin{Theorem}(\cite{Dedekind_Number_Asymptotics, Kleitman_Markowsky})
    Верхняя и нижняя оценки логарифма $\psi(n)$ имеют следующий вид:
    $${n\choose \lfloor n/2\rfloor}\le \log_2 \psi(n)\le {n\choose \lfloor n/2\rfloor}\left(1+O\left(\frac{\log n}{n}\right)\right).$$
   \end{Theorem}

Определим \emph{матрицу предшествий} векторов из $B^n$ следующим образом: 
$M_n = m_{i,j}$ имеет размерность $2^n \times 2^n$, и для каждой пары векторов
$\al, \be \in B^n$ таких, что $\#(a) = i$ и $\#(b) = j$, мы полагаем
$m_{i,j} = 1$, если $\al \preceq \be$, и $m_{i,j} = 0$ в противном случае $(0 \leq i, j \leq 2^n-1)$.
\begin{Theorem} \label{Th_matrix_Mn}
(\cite{bakoev2012})
 Матрица $M_n$ есть блочная матрица, определенная рекурсивно, или с помощью 
 произведения Кронекера:\\
 
 $M_1 = \begin{pmatrix}
        1 & 1\\
        0 & 1
       \end{pmatrix}, \quad$ 
 $M_n = \begin{pmatrix}
        M_{n-1} & M_{n-1}\\
        O_{n-1} & M_{n-1}
       \end{pmatrix},\quad$ 
       или
       $\quad M_n = M_1 \otimes M_{n-1} = \bigotimes\limits^n_{i=1} M_i$, \\
  где $M_{n-1}$ есть аналогичная матрица размерности $2^{n-1} \times 2^{n-1}$,
  $O_{n-1}$ -- нулевая матрица размерности $2^{n-1} \times 2^{n-1}$, 
  $\otimes$ -- произведение Кронекера (\cite{Kronecker_product}).
\end{Theorem}
\begin{Theorem}\label{Th_fun_values_implicants}
(\cite{bakoev2012})
 Пусть $\al = (a_1, a_2, \dots, a_n) \in B^n,\ \#(\al) = i,\ 
 1 \leq i \leq 2^n -1 $,
 и $\al$ имеет единицы в позициях $(i_1, i_2, \dots,i_k),\ 1 \leq k \leq n$.
 Тогда $i$-я строка $r_i$ матрицы $M_n$ есть вектор функциональных значений
 простой импликанты $c_i = x_{i_1}x_{i_2\dots x_{i_k}}$, т.е. $\al$ -- это 
 характеристический вектор литералов в $c_i$, являющейся МБФ.
 Если $\#(\al)=0$, то нулевая по счету строка в $M_n$ соответствует константе $1$. 
\end{Theorem}

\begin{center}
 \begin{tabular}{ c | c | c | l }
  $\al = (x_1, x_2, x_3)$ & $i = \#(\al)$ & $M_3$ & $c_i$ \\
  \hline
  (0 0 0) & 	0	& 1 1 1 1\ \ 1 1 1 1 & 1 \T  \\
  (0 0 1) & 	1	& 0 1 0 1\ \ 0 1 0 1 & $x_3$     \\
  (0 1 0) & 	2	& 0 0 1 1\ \ 0 0 1 1 & $x_2$     \\
  (0 1 1) & 	3	& 0 0 0 1\ \ 0 0 0 1 & $x_2x_3$   \\
  (1 0 0) & 	4	& 0 0 0 0\ \ 1 1 1 1 & $x_1$     \\
  (1 0 1) & 	5	& 0 0 0 0\ \ 0 1 0 1 & $x_1x_3$   \\
  (1 1 0) & 	6	& 0 0 0 0\ \ 0 0 1 1 & $x_1x_2$   \\
  (1 1 1) & 	7	& 0 0 0 0\ \ 0 0 0 1 & $x_1x_2x_3$ \B \\
  \hline
  \end{tabular}
\captionof{table}{
 Иллюстрация утверждения Tеоремы \ref{Th_fun_values_implicants} для $n = 3$
  }
\end{center}
  
  Итак, вектор функциональных значений любой МБФ $f$ может быть представлен
  в виде линейной комбинации 
  $f(x_1, x_2, \dots, x_n) = a_0 r_0 \vee a_1 r_1 \dots a_{2^n-1} r_{2^n-1}$, 
  где $r_i$ -- $i$-я строка матрицы $M_n$, коэффициенты $a_i \in \{0,1\}$, для
  $i = \overline{0, 2^n - 1}$. Другими словами, 
  $M_n$ играет роль порождающей матрицы для множества всех МБФ от $n$ переменных.
  Если $f(x_1, x_2, \dots, x_n) = r_{i_1} \vee r_{i_2} \vee \dots \vee r_{i_k}$
  соответствует МДНФ функции $f$, тогда любые 2 строки $r_{i_j}$ и $r_{i_l}$ 
  (соответствующие простым импликантам $c_{i_j}$ и $c_{i_l}$), $1 \leq j < l \leq k$,
  взаимно несравнимы (в противном случае мы могли бы применить правило поглощения, 
  что противоречит минимальности ДНФ).
    Приведем алгоритм, генерирующий все МБФ от $n$ переменных, $1 \leq n \leq 7$,
    как вектора в лексикографическом порядке. Он основан на свойствах матрицы
    $M_n$ (более подробно описано в \cite{bakoev2003}).\\
    \textbf{Алгоритм:} GEN.\\
    \textbf{Вход:} число переменных $n$.\\
    \textbf{Выход:} вектора всех МБФ от $n$ переменных в лексикографическом порядке.\\
    \textbf{Псевдокод:}\par
      \begin{enumerate}
      \item Генерируем матрицу $M_n$. 
      \item $f = (0, 0, \dots, 0)$. Выводим  $f$.
      \item Для каждой строки $r_i$ в $M_n$, $i = 2^n - 1, \dots, 0$, 
	устанавливаем $f = r_i$ и:\par
	\newcounter{N}
	\begin{list}{\alph{N})}{\usecounter{N}} 
	\item выводим $f$;
	\item для каждой позиции $j,\ j = 2^n -2, 2^n - 3, \dots, i+1$, 
	  проверяем $f[j] = 0 ?$, 
	  т.е. являются ли $i$-ая $j$-ая строки несравнимыми. Если ``Да'', тогда
	  рекурсивно полагаем $f = f \vee r_j$ и переходим к шагу 3.a)
	\end{list}
      \item Конец.
      \end{enumerate}
Шаги 3.a и 3.b, написанные на C++, выглядят так:
\lstset{language=C++,basicstyle=\footnotesize}
\begin{lstlisting}
void Gen_I ( bool G[], int i ) {
  bool H [Max_Dim];
  for ( int k=i; k<N; k++ )	// N= 2^n is a global variable
    H[k]= G[k] || M[i][k];	// M is M_n
  Print ( H );
  for ( int j= N-1; j>i; j-- )	// step 3.b
    if ( !H[j] ) Gen_I ( H, j );
}
\end{lstlisting}


